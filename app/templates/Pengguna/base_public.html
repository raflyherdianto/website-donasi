<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{% block title %}Donasi Buku Perpustakaan Desa - Kabupaten Lumajang{% endblock %}</title>
    
    <!-- CSS Framework -->
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
    
    <!-- Favicon -->
    <link rel="icon" type="image/png" href="{{ url_for('static', filename='images/logo2.png') }}">
    
    <!-- Custom Styles -->
    <style>
        .dropdown-content {
            display: none;
            position: absolute;
            background-color: #ffffff;
            min-width: 160px;
            max-width: 200px;
            box-shadow: 0px 8px 16px rgba(0,0,0,0.1);
            z-index: 50;
            top: 100%;
            right: 0;
            border-radius: 8px;
            overflow: hidden;
            transition: opacity 0.2s ease-in-out;
            border: 1px solid #e5e7eb;
        }
        
        @media (max-width: 768px) {
            .dropdown-content {
                min-width: 140px;
                right: -10px;
            }
        }
        
        .show-dropdown {
            display: block !important;
            animation: fadeIn 0.2s ease-in-out;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(-4px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .dropdown-content a {
            display: block;
            padding: 12px 16px;
            color: #1e293b;
            text-decoration: none;
            transition: background 0.2s ease-in-out;
            white-space: nowrap;
            font-size: 14px;
        }

        .dropdown-content a:hover {
            background-color: #f1f5f9;
        }
        
        .profile-dropdown {
            right: 0;
            left: auto;
        }
    </style>
    
    {% block extra_head %}{% endblock %}
</head>
<body class="bg-gray-100 min-h-screen">
    <!-- Toast Container -->
    <div id="toast-container" class="fixed top-4 right-4 z-50 space-y-2"></div>

    <!-- Navbar -->
    {% include "pengguna/navbar.html" %}

    <!-- Main Content -->
    <main class="min-h-screen">
        {% block content %}{% endblock %}
    </main>

    <!-- Footer -->
    {% include "pengguna/footer.html" %}

    <!-- Base JavaScript -->
    <script>
        // Initialize year
        document.getElementById('current-year').textContent = new Date().getFullYear();

        // Toast Notification System
        function showToast(message, type = 'info', duration = 4000) {
            const toastContainer = document.getElementById('toast-container');
            const toast = document.createElement('div');
            
            const typeClasses = {
                'success': 'bg-green-500 text-white',
                'error': 'bg-red-500 text-white',
                'warning': 'bg-yellow-500 text-white',
                'info': 'bg-blue-500 text-white'
            };
            
            toast.className = `${typeClasses[type]} px-6 py-3 rounded-lg shadow-lg transform transition-all duration-300 translate-x-full opacity-0 max-w-sm`;
            toast.innerHTML = `
                <div class="flex items-center justify-between">
                    <span class="text-sm font-medium">${message}</span>
                    <button onclick="closeToast(this)" class="ml-4 text-white hover:text-gray-200">
                        <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
                        </svg>
                    </button>
                </div>
            `;
            
            toastContainer.appendChild(toast);
            
            setTimeout(() => {
                toast.classList.remove('translate-x-full', 'opacity-0');
            }, 100);
            
            setTimeout(() => {
                closeToast(toast.querySelector('button'));
            }, duration);
        }
        
        function closeToast(button) {
            const toast = button.closest('div').parentElement;
            toast.classList.add('translate-x-full', 'opacity-0');
            setTimeout(() => {
                if (toast.parentElement) {
                    toast.parentElement.removeChild(toast);
                }
            }, 300);
        }

        // Show flash messages as toasts
        {% with messages = get_flashed_messages(with_categories=true) %}
            {% if messages %}
                {% for category, message in messages %}
                    showToast('{{ message }}', '{{ category }}');
                {% endfor %}
            {% endif %}
        {% endwith %}

        // Dropdown functionality
        function toggleDropdown(e, id) {
            e.preventDefault();
            const dropdown = document.getElementById(id);
            dropdown.classList.toggle("show-dropdown");
            document.querySelectorAll(".dropdown-content").forEach(el => {
                if (el !== dropdown) el.classList.remove("show-dropdown");
            });
        }

        function toggleMobileMenu() {
            const menu = document.getElementById("mobile-menu");
            menu.classList.toggle("hidden");
        }

        document.addEventListener("click", function (e) {
            if (!e.target.closest(".relative")) {
                document.querySelectorAll(".dropdown-content").forEach(el => {
                    el.classList.remove("show-dropdown");
                });
            }
        });
    </script>

    {% block extra_js %}{% endblock %}
</body>
</html>